
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Versioning/">
      
      
        <link rel="next" href="../Compatibility/">
      
      <link rel="icon" href="../../images/favicon_logo.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.7">
    
    
      
        <title>Upgrade - Delphix Virtualization SDK 4.1.0</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Helvetica+Neue:300,300i,400,400i,700,700i%7CConsolas:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Helvetica Neue";--md-code-font:"Consolas"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/delphix-brand.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-35429885-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");ga("send","event","feedback","click",t,e),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){ga("send","pageview",e.pathname)})});var e=document.createElement("script");e.async=!0,e.src="https://www.google-analytics.com/analytics.js",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#upgrade" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Delphix Virtualization SDK 4.1.0" class="md-header__button md-logo" aria-label="Delphix Virtualization SDK 4.1.0" data-md-component="logo">
      
  <img src="../../images/header_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Delphix Virtualization SDK 4.1.0
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Upgrade
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/delphix/virtualization-sdk/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Delphix Virtualization SDK
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Welcome!
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../Getting_Started/" class="md-tabs__link">
      Getting Started
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Building_Your_First_Plugin/Overview/" class="md-tabs__link">
        Building Your First Plugin
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../Overview/" class="md-tabs__link md-tabs__link--active">
        Versioning And Upgrade
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../References/CLI/" class="md-tabs__link">
        References
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Best_Practices/CLI_Configuration_File/" class="md-tabs__link">
        Best Practices
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../Release_Notes/4.1.0/4.1.0/" class="md-tabs__link">
        Release Notes
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Delphix Virtualization SDK 4.1.0" class="md-nav__button md-logo" aria-label="Delphix Virtualization SDK 4.1.0" data-md-component="logo">
      
  <img src="../../images/header_logo.png" alt="logo">

    </a>
    Delphix Virtualization SDK 4.1.0
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/delphix/virtualization-sdk/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Delphix Virtualization SDK
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome!
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Getting_Started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Building Your First Plugin
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Building Your First Plugin
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Building_Your_First_Plugin/Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Building_Your_First_Plugin/Initial_Setup/" class="md-nav__link">
        Initial Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Building_Your_First_Plugin/Discovery/" class="md-nav__link">
        Discovery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Building_Your_First_Plugin/Data_Ingestion/" class="md-nav__link">
        Data Ingestion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Building_Your_First_Plugin/Provisioning/" class="md-nav__link">
        Provisioning
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Versioning And Upgrade
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Versioning And Upgrade
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Versioning/" class="md-nav__link">
        Versioning
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Upgrade
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Upgrade
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-migrations" class="md-nav__link">
    Data Migrations
  </a>
  
    <nav class="md-nav" aria-label="Data Migrations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-a-data-migration" class="md-nav__link">
    What is a Data Migration?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-simple-example" class="md-nav__link">
    A Simple Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rules-for-data-migrations" class="md-nav__link">
    Rules for Data Migrations
  </a>
  
    <nav class="md-nav" aria-label="Rules for Data Migrations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rules" class="md-nav__link">
    Rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    Recommendations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-migration-example" class="md-nav__link">
    Data Migration Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugging-data-migration-problems" class="md-nav__link">
    Debugging Data Migration Problems
  </a>
  
    <nav class="md-nav" aria-label="Debugging Data Migration Problems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-concerns-prevent-detailed-error-messages" class="md-nav__link">
    Security Concerns Prevent Detailed Error Messages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#one-solution-temporary-logging" class="md-nav__link">
    One Solution: Temporary Logging
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-data-migrations-are-insufficient" class="md-nav__link">
    When Data Migrations Are Insufficient
  </a>
  
    <nav class="md-nav" aria-label="When Data Migrations Are Insufficient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#autodiscovery-example" class="md-nav__link">
    Autodiscovery Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-entry" class="md-nav__link">
    Manual Entry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Compatibility/" class="md-nav__link">
        Compatibility
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Backports_And_Hotfixes/" class="md-nav__link">
        Backports and Hotfixes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Replication/" class="md-nav__link">
        Replication
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
      
      
      
        <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
          Lua Toolkit To SDK Plugin Migration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_7">
          <span class="md-nav__icon md-icon"></span>
          Lua Toolkit To SDK Plugin Migration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Lua_Toolkit_To_SDK_Plugin_Migration/Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Lua_Toolkit_To_SDK_Plugin_Migration/Plugin_Config/" class="md-nav__link">
        Plugin Config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Lua_Toolkit_To_SDK_Plugin_Migration/Decorators/" class="md-nav__link">
        Decorators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Lua_Toolkit_To_SDK_Plugin_Migration/Plugin_Operations/" class="md-nav__link">
        Plugin Operations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Lua_Toolkit_To_SDK_Plugin_Migration/Converting_Migration_Scripts/" class="md-nav__link">
        Converting Lua Upgrade Scripts to Python Data Migrations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          References
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          References
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../References/CLI/" class="md-nav__link">
        CLI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../References/Plugin_Config/" class="md-nav__link">
        Plugin Config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../References/Decorators/" class="md-nav__link">
        Decorators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../References/Plugin_Operations/" class="md-nav__link">
        Plugin Operations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../References/Schemas/" class="md-nav__link">
        Schemas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../References/Schemas_and_Autogenerated_Classes/" class="md-nav__link">
        Schemas and Autogenerated Classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../References/Platform_Libraries/" class="md-nav__link">
        Platform Libraries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../References/Logging/" class="md-nav__link">
        Logging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../References/Workflows/" class="md-nav__link">
        Workflows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../References/Classes/" class="md-nav__link">
        Classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../References/Glossary/" class="md-nav__link">
        Glossary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../References/Version_Compatibility/" class="md-nav__link">
        Virtualization SDK Version Compatibility
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Best Practices
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Best Practices
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Best_Practices/CLI_Configuration_File/" class="md-nav__link">
        CLI Configuration File
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Best_Practices/Code_Sharing/" class="md-nav__link">
        Code Sharing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Best_Practices/Managing_Scripts_For_Remote_Execution/" class="md-nav__link">
        Managing Scripts for Remote Execution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Best_Practices/User_Visible_Errors/" class="md-nav__link">
        User Visible Errors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Best_Practices/Sensitive_Data/" class="md-nav__link">
        Dealing With Sensitive Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Best_Practices/Strings/" class="md-nav__link">
        Working With Strings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Best_Practices/Runtime_Environment/" class="md-nav__link">
        Plugin Runtime Environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Best_Practices/Working_with_Powershell/" class="md-nav__link">
        Working with Powershell
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Best_Practices/Scratch_Paths/" class="md-nav__link">
        Scratch Paths
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Best_Practices/Message_Limits/" class="md-nav__link">
        Message Limits
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Release Notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Release Notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
      
      
      
        <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
          4.1.0
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          4.1.0
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/4.1.0/4.1.0/" class="md-nav__link">
        Release - v4.1.0
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
      
      
      
        <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
          4.0.5
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_2">
          <span class="md-nav__icon md-icon"></span>
          4.0.5
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/4.0.5/4.0.5/" class="md-nav__link">
        Release - v4.0.5
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
      
      
      
        <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
          4.0.2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_3">
          <span class="md-nav__icon md-icon"></span>
          4.0.2
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/4.0.2/4.0.2/" class="md-nav__link">
        Release - v4.0.2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/4.0.2/4.0.2_Breaking_Changes/" class="md-nav__link">
        Breaking Changes - v.4.0.2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
      
      
      
        <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
          3.1.0
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4">
          <span class="md-nav__icon md-icon"></span>
          3.1.0
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/3.1.0/3.1.0/" class="md-nav__link">
        Release - v3.1.0
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
      
      
      
        <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
          3.0.0
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          3.0.0
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/3.0.0/3.0.0/" class="md-nav__link">
        Release - v3.0.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/3.0.0/3.0.0_Breaking_Changes/" class="md-nav__link">
        Breaking Changes - v.3.0.0
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
      
      
      
        <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
          2.1.0
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_6">
          <span class="md-nav__icon md-icon"></span>
          2.1.0
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/2.1.0/2.1.0/" class="md-nav__link">
        Release - v2.1.0
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
          2.0.0
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          2.0.0
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/2.0.0/2.0.0/" class="md-nav__link">
        Release - v2.0.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/2.0.0/2.0.0_Breaking_Changes/" class="md-nav__link">
        Breaking Changes - GA (v.2.0.0)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_8" >
      
      
      
        <label class="md-nav__link" for="__nav_7_8" id="__nav_7_8_label" tabindex="0">
          1.0.0
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_8">
          <span class="md-nav__icon md-icon"></span>
          1.0.0
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/1.0.0/1.0.0/" class="md-nav__link">
        Release - v1.0.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/1.0.0/1.0.0_Breaking_Changes/" class="md-nav__link">
        Breaking Changes - GA (v.1.0.0)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_9" >
      
      
      
        <label class="md-nav__link" for="__nav_7_9" id="__nav_7_9_label" tabindex="0">
          0.4.0
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_9">
          <span class="md-nav__icon md-icon"></span>
          0.4.0
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/0.4.0/0.4.0/" class="md-nav__link">
        Release - Early Preview 2 (v0.4.0)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release_Notes/0.4.0/0.4.0_Breaking_Changes/" class="md-nav__link">
        Breaking Changes - Early Preview 2 (v.0.4.0)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-migrations" class="md-nav__link">
    Data Migrations
  </a>
  
    <nav class="md-nav" aria-label="Data Migrations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-a-data-migration" class="md-nav__link">
    What is a Data Migration?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-simple-example" class="md-nav__link">
    A Simple Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rules-for-data-migrations" class="md-nav__link">
    Rules for Data Migrations
  </a>
  
    <nav class="md-nav" aria-label="Rules for Data Migrations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rules" class="md-nav__link">
    Rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    Recommendations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-migration-example" class="md-nav__link">
    Data Migration Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugging-data-migration-problems" class="md-nav__link">
    Debugging Data Migration Problems
  </a>
  
    <nav class="md-nav" aria-label="Debugging Data Migration Problems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-concerns-prevent-detailed-error-messages" class="md-nav__link">
    Security Concerns Prevent Detailed Error Messages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#one-solution-temporary-logging" class="md-nav__link">
    One Solution: Temporary Logging
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-data-migrations-are-insufficient" class="md-nav__link">
    When Data Migrations Are Insufficient
  </a>
  
    <nav class="md-nav" aria-label="When Data Migrations Are Insufficient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#autodiscovery-example" class="md-nav__link">
    Autodiscovery Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-entry" class="md-nav__link">
    Manual Entry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="upgrade">Upgrade<a class="headerlink" href="#upgrade" title="Permanent link">&para;</a></h1>
<p>Upgrade is the process of moving from an older version of a plugin to a newer version.
Upgrading is not as simple as just replacing the installed plugin with a newer one.  The main complication comes when the new plugin version makes changes to its <a href="../../References/Glossary/#schema">schemas</a>.</p>
<p>Consider the case of a plugin that works with collections of text files -- the user points it to a directory tree containing text files, and the plugin syncs the files from there.</p>
<p>The first release of such a plugin might have no link-related user options. So the plugin's linked source schema might define no properties at all:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">&quot;linkedSourceDefinition&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="nt">&quot;additionalProperties&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="nt">&quot;properties&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">}</span>
</code></pre></div>
<p>And, the syncing code is very simple:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nd">@plugin</span><span class="o">.</span><span class="n">linked</span><span class="o">.</span><span class="n">pre_snapshot</span><span class="p">()</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="k">def</span> <span class="nf">linked_pre_snapshot</span><span class="p">(</span><span class="n">direct_source</span><span class="p">,</span> <span class="n">repository</span><span class="p">,</span> <span class="n">source_config</span><span class="p">):</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="n">libs</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>        <span class="n">remote_connection</span> <span class="o">=</span> <span class="n">direct_source</span><span class="o">.</span><span class="n">connection</span><span class="p">,</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>        <span class="n">source_directory</span> <span class="o">=</span> <span class="n">source_config</span><span class="o">.</span><span class="n">path</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>        <span class="p">)</span>
</code></pre></div></p>
<p>But, later, some users request a new feature -- they want to avoid syncing any backup or hidden files. So, a new plugin version is released. This time, there is a new boolean property in the linked source schema where users can elect to skip these files, if desired.
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nt">&quot;linkedSourceDefinition&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">    </span><span class="nt">&quot;additionalProperties&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;skipHiddenAndBackup&quot;</span><span class="p">],</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">    </span><span class="nt">&quot;properties&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">      </span><span class="nt">&quot;skipHiddenAndBackup&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="p">}</span>
</code></pre></div></p>
<p>The plugin code that handles the syncing can now pay attention to this new boolean property:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">_HIDDEN_AND_BACKUP_SPECS</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="s2">&quot;*.bak&quot;</span><span class="p">,</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="s2">&quot;*~&quot;</span><span class="p">,</span>  <span class="c1"># Backup files from certain editors</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="s2">&quot;.*&quot;</span>  <span class="c1"># Unix-style hidden files</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="p">]</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="nd">@plugin</span><span class="o">.</span><span class="n">linked</span><span class="o">.</span><span class="n">pre_snapshot</span><span class="p">()</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="k">def</span> <span class="nf">linked_pre_snapshot</span><span class="p">(</span><span class="n">direct_source</span><span class="p">,</span> <span class="n">repository</span><span class="p">,</span> <span class="n">source_config</span><span class="p">):</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    <span class="n">exclude_spec</span> <span class="o">=</span> <span class="n">_HIDDEN_AND_BACKUP_SPECS</span> <span class="k">if</span> <span class="n">direct_source</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">skip_hidden_and_backup</span> <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    <span class="n">libs</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>        <span class="n">remote_connection</span> <span class="o">=</span> <span class="n">direct_source</span><span class="o">.</span><span class="n">connection</span><span class="p">,</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>        <span class="n">source_directory</span> <span class="o">=</span> <span class="n">source_config</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>        <span class="n">exclude_paths</span> <span class="o">=</span> <span class="n">exclude_spec</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>        <span class="p">)</span>
</code></pre></div></p>
<p>Suppose a user has an engine with linked sources created by the older version of this plugin. That is, the existing linked sources have no <code>skipHiddenAndBackup</code> property.</p>
<p>If the user installs the new version of the plugin, we have a problem! The above <code>pre_snapshot</code> code from the new plugin will attempt to access the <code>skip_hidden_and_backup</code> property, which we've just seen will not exist!</p>
<p>The solution to this problem is to use <a href="../../References/Glossary/#data-migration">data migrations</a>, explained below.</p>
<div class="admonition info">
<p class="admonition-title">Zero dSource and VDB downtime during plugin upgrade</p>
<p>dSources and VDBs do not need to be disabled before a plugin upgrade is initiated. End users can continue to access data from existing VDBs during a plugin upgrade. However, while a particular plugin is in the process of being upgraded, no administrative Delphix Engine operations like: VDB Refresh, VDB Provision, dSource Disable/Enable etc will be allowed on the objects associated with that plugin. Objects associated with other plugins will not be affected.</p>
</div>
<h2 id="data-migrations">Data Migrations<a class="headerlink" href="#data-migrations" title="Permanent link">&para;</a></h2>
<h3 id="what-is-a-data-migration">What is a Data Migration?<a class="headerlink" href="#what-is-a-data-migration" title="Permanent link">&para;</a></h3>
<p>Whenever a new version of a plugin is installed on a Delphix Engine, the engine needs to migrate pre-existing data from its old format (as specified by the schemas in the old version of the plugin), to its new format (as specified by the schemas in the new version of the plugin).</p>
<p>A <a href="../../References/Glossary/#data-migration">data migration</a> is a function that is responsible for doing this conversion. It is provided by the plugin.</p>
<p>Thus, when the new plugin version is installed, the engine will call all applicable data migrations provided by the new plugin. This ensures that all data is always in the format expected by the new plugin.</p>
<h3 id="a-simple-example">A Simple Example<a class="headerlink" href="#a-simple-example" title="Permanent link">&para;</a></h3>
<p>Let's go back to the above example of the plugin that adds a new boolean option to allow users to avoid syncing backup and hidden files. Here is a data migration that the new plugin can provide to handle the data format change:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nd">@plugin</span><span class="o">.</span><span class="n">upgrade</span><span class="o">.</span><span class="n">linked_source</span><span class="p">(</span><span class="s2">&quot;2019.11.20&quot;</span><span class="p">)</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">def</span> <span class="nf">add_skip_option</span><span class="p">(</span><span class="n">old_linked_source</span><span class="p">):</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>      <span class="s2">&quot;skipHiddenAndBackup&quot;</span><span class="p">:</span> <span class="n">false</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="p">}</span>
</code></pre></div>
<p>The exact rules for data migrations are covered in detail <a href="./#rules-for-data-migrations">below</a>. Here, we'll just walk through this code line by line and make some observations.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nd">@plugin</span><span class="o">.</span><span class="n">upgrade</span><span class="o">.</span><span class="n">linked_source</span><span class="p">(</span><span class="s2">&quot;2019.11.20&quot;</span><span class="p">)</span>
</code></pre></div>
The above line is a <a href="../../References/Glossary/#decorator">decorator</a> that identifies the following function as a data migration. This particular migration will handle linked sources. It is given an ID of <code>2019.11.20</code> -- this controls when this migration is run in relation to other data migrations.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">def</span> <span class="nf">add_skip_option</span><span class="p">(</span><span class="n">old_linked_source</span><span class="p">):</span>
</code></pre></div>
<p>Note that the data migration takes an argument representing the old-format data. In this simple example, we know that there are no properties in the old-format data, so we can just ignore it.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>    <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>      <span class="s2">&quot;skipHiddenAndBackup&quot;</span><span class="p">:</span> <span class="n">false</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    <span class="p">}</span>
</code></pre></div>
<p>Here, we are returning a Python dictionary representing the new format of the data. In this example, the dictionary has only one field: <code>skipHiddenAndBackup</code>. Because the old version of the plugin had no ability to skip files, we default this property to <code>false</code> to match the new schema.</p>
<h3 id="rules-for-data-migrations">Rules for Data Migrations<a class="headerlink" href="#rules-for-data-migrations" title="Permanent link">&para;</a></h3>
<p>As shown above, the a data migration receives old-format input and produces new-format output. The rules and recommendations for data migrations follow:</p>
<h4 id="rules">Rules<a class="headerlink" href="#rules" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>Input and output are Python dictionaries, with properties named exactly as specified in the schemas. Note that this differs from other plugin operations, where the inputs are defined with autogenerated Python <a href="../../References/Schemas_and_Autogenerated_Classes/">classes</a>, and whose properties use Python-style naming.</p>
</li>
<li>
<p>Each data migration must be tagged with an ID string. This string must consist of one or more positive integers separated by periods.</p>
</li>
<li>
<p>Data migration IDs must be numerically unique. Note that <code>"1.2"</code>, <code>"01.02"</code>, and "<code>1.2.0.0.0"</code> are all considered to be identical.</p>
</li>
<li>
<p>Once released, a data migration must never be deleted. An attempted upgrade will fail if the already-installed plugin version has a data migration that does not appear in the to-be-installed version.</p>
</li>
<li>
<p>At upgrade time, the engine will find the set of new migrations provided by the new version that are not already part of the already-installed version. Each of these migrations will then be run, in the order specified below.</p>
</li>
<li>
<p>After running all applicable migrations, the engine will confirm that the resultant data conforms to the new version's schemas. If not, the upgrade will fail.</p>
</li>
<li>
<p>Note that there is no requirement or guarantee that the input or output of any particular data migration will conform to a schema. We only guarantee that the input to the <strong>first</strong> data migration conforms to the schema of the already-installed plugin version. And, we only require that the output of the <strong>final</strong> data migration conforms to the schema of the new plugin version.</p>
</li>
<li>
<p>Data migrations are run in the order specified by their IDs. The ordering is numerical, not lexicographical. Thus <code>"1"</code> would run before <code>"2"</code>, which would run before <code>"10"</code>.</p>
</li>
<li>
<p>With the exception of <a href="../../References/Platform_Libraries/#upgrade_password"><code>upgrade_password</code></a>, data migrations have no access to most <a href="../../References/Platform_Libraries/">Platform Libraries</a> or remote hosts. For example: If a data migration attempts to use <a href="../../References/Platform_Libraries/#run_bash">run_bash</a> the upgrade will fail.</p>
</li>
<li>
<p>Password properties can be generalized to <a href="../../References/Schemas/#credentialssupplier">credential-supplying objects</a> that offer alternative mechanisms for obtaining passwords and secrets, such as password vaults. To achieve that, a data migration must call <a href="../../References/Platform_Libraries/#upgrade_password"><code>upgrade_password</code></a>.</p>
</li>
<li>
<p>Note that the above rules imply that at least one data migration is required any time a schema change is made that would invalidate any data produced using a previous version of the plugin. For example: adding a <code>"required"</code> property to the new schema.</p>
</li>
</ul>
<h4 id="recommendations">Recommendations<a class="headerlink" href="#recommendations" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>We recommend using a "Year.Month.Date" format like <code>"2019.11.04"</code> for migration IDs. You can use trailing integers as necessary (e.g. use <code>"2019.11.04.5"</code> if you need something to be run between <code>"2019.11.04"</code> and <code>"2019.11.05"</code>).</p>
</li>
<li>
<p>Even though they follow similar naming rules, migration IDs are not the same thing as plugin versions. We do not recommend using your plugin version in your migration IDs.</p>
</li>
<li>
<p>We recommend using small, single-purpose data migrations. That is, if you end up making four schema changes over the course of developing a new plugin version, we recommend writing four different data migrations, one for each change.</p>
</li>
</ul>
<h3 id="data-migration-example">Data Migration Example<a class="headerlink" href="#data-migration-example" title="Permanent link">&para;</a></h3>
<p>Here is a very simple data migration.
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nd">@plugin</span><span class="o">.</span><span class="n">upgrade</span><span class="o">.</span><span class="n">repository</span><span class="p">(</span><span class="s2">&quot;2019.12.15&quot;</span><span class="p">)</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="k">def</span> <span class="nf">add_new_flag_to_repo</span><span class="p">(</span><span class="n">old_repository</span><span class="p">):</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>  <span class="n">new_repository</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">old_repository</span><span class="p">)</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>  <span class="n">new_repository</span><span class="p">[</span><span class="s2">&quot;useNewFeature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>  <span class="k">return</span> <span class="n">new_repository</span>
</code></pre></div></p>
<h3 id="debugging-data-migration-problems">Debugging Data Migration Problems<a class="headerlink" href="#debugging-data-migration-problems" title="Permanent link">&para;</a></h3>
<p>During the process of upgrading to a new version, the Delphix Engine will run all applicable data migrations, and then ensure that the resulting object matches the new schema. But, what if there is a bug, and the resulting object does <strong>not</strong> match the schema?</p>
<h4 id="security-concerns-prevent-detailed-error-messages">Security Concerns Prevent Detailed Error Messages<a class="headerlink" href="#security-concerns-prevent-detailed-error-messages" title="Permanent link">&para;</a></h4>
<p>One problem here is that the Delphix Engine is limited in the information that it can provide in the error message. Ideally, the engine would say exactly what was wrong with the object (e.g.: "The field <code>port</code> has the value <code>15</code>, but the schema says it has to have a value between <code>256</code> and <code>1024</code>").</p>
<p>But, the Delphix Engine cannot do this for security reasons. Ordinarily, the Delphix Engine knows which fields contain sensitive information, and can redact such fields from error messages. But, the only reason the Delphix Engine has that knowledge is because the schema provides that information. If an object does <strong>not</strong> conform to the schema, then the Delphix Engine can't know what is sensitive and what isn't.</p>
<p>Therefore, the error message here might lack the detail necessary to debug the problem.</p>
<h4 id="one-solution-temporary-logging">One Solution: Temporary Logging<a class="headerlink" href="#one-solution-temporary-logging" title="Permanent link">&para;</a></h4>
<p>During development of a new plugin version, you may find yourself trying to find and fix such a bug.
One technique is to use temporary logging.</p>
<p>For example, while you are trying to locate and fix the bug, you could put a log statement at the very end of each of your data migrations, like so:
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>  logger.debug(&quot;Migration 2010.03.01 returning {}&quot;.format(new_object))
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>  return new_object
</code></pre></div></p>
<p>See the <a href="../../References/Logging/">Logging</a> section for more information about logging works.</p>
<p>From the logs, you'll be able to see exactly what each migration is returning. From there, hopefully the problem will become apparent. As a supplemental tool, consider pasting these results (along with your schema) into an online JSON validator for more information.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is <strong>very important</strong> that you only use logging as a temporary debugging strategy. <strong>Such logging must be removed before you release the plugin to end users</strong>. If this logging ends up in your end product, it could cause a serious security concern. Please see our <a href="../../Best_Practices/Sensitive_Data/">sensitive data best practices</a> for more information.</p>
</div>
<h3 id="when-data-migrations-are-insufficient">When Data Migrations Are Insufficient<a class="headerlink" href="#when-data-migrations-are-insufficient" title="Permanent link">&para;</a></h3>
<p>New versions of plugins often require some modification of data that was written using an older version of the same plugin. Data migrations handle this modification. Unfortunately, data migrations cannot always fully handle all possible upgrade scenarios by themselves.</p>
<p>For example, a new plugin version might want to add a new required field to one of its schemas. But, the correct value for this new field might not be knowable while the upgrade is underway -- perhaps it must be entered by the user, or perhaps it would require automatic discovery to be rerun.</p>
<p>Such a situation will require some user intervention after the upgrade.</p>
<p>In all cases, of course you will want to <strong>clearly document</strong> to your users that there will extra work required so they can make sure they known what they are getting into before they decide to upgrade.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It should also be said that you should try to avoid cases like this.  As much as possible, try to make your post-upgrade plugin function with no user intervention. Only resort to user intervention as a last resort.</p>
</div>
<p>The recommended strategy here is to arrange for the affected objects to be in an "invalid" state, and for your plugin code to detect this state, and throw errors when the objects are used.</p>
<p>For such a situation, we recommend the following process:</p>
<ul>
<li>Make your schema changes so that the affected property can be set in such a way that plugin code can identify it as being invalid. Typically this is done by allowing for some "sentinel" value. This may require you to have a less-strict schema definition than you might otherwise want.</li>
<li>In your data migrations, make sure the affected properties are indeed marked invalid.</li>
<li>In any plugin code that needs to use these properties, first check them for validity. If they are invalid, then raise an error that explains the situation to the user, and tells them what steps they need to take.</li>
</ul>
<p>Following are two examples of schema changes that need extra user intervention after upgrade. One will require a rediscovery, and the other will require the user to enter information.</p>
<h4 id="autodiscovery-example">Autodiscovery Example<a class="headerlink" href="#autodiscovery-example" title="Permanent link">&para;</a></h4>
<p>Suppose that a new plugin version adds a new required field to its repository schema. This new field specifies a full path to a database installation. The following listing shows what we'd ideally like the new repository schema to look like (<code>installationPath</code> is the new required property)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>&quot;repositoryDefinition&quot;: {
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    &quot;type&quot;: &quot;object&quot;,
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>    &quot;properties&quot;: {
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>        &quot;name&quot;: { &quot;type&quot;: &quot;string&quot; },
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>        &quot;installationPath&quot;: { &quot;type&quot;: &quot;string&quot;, &quot;format&quot;: &quot;unixpath&quot;}
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>    },
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>    &quot;required&quot;: [&quot;name&quot;, &quot;installationPath&quot;],
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    &quot;nameField&quot;: &quot;name&quot;,
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>    &quot;identityFields&quot;: [&quot;name&quot;]
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>}
</code></pre></div>
<p>The new plugin's autodiscovery code will know how to find this full path. Therefore, any repositories that are discovered (or rediscovered) after the upgrade will have this path filled in correctly.</p>
<p>But, there may be repositories that were discovered before the upgrade. The data migrations will have to ensure that <em>some</em> value is provided for this new field. However, a data migration will not be able to determine what the correct final value is.</p>
<p>One way to handle this is to modify the schema to allow a special value to indicate that the object needs to be rediscovered. In this example, we'll change the schema from the ideal version above, removing the <code>unixpath</code> constraint on this string:
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>&quot;installationPath&quot;: { &quot;type&quot;: &quot;string&quot; }
</code></pre></div></p>
<p>Now, our data migration can set this property to some special sentinel value that will never be mistaken for an actual installation path.
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>_REDISCOVERY_TOKEN = &quot;###_REPOSITORY_NEEDS_REDISCOVERY_###&quot;
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>@plugin.upgrade.repository(&quot;2020.02.04.01&quot;)
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>def repo_path(old_repository):
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>    # We need to add in a repository path, but there is no way for us to know
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>    # what the correct path is here, so we cannot set this to anything useful.
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>    # Instead, we&#39;ll set a special sentinel value that will indicate that the
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>    # repository is unusable until the remote host is rediscovered.
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>    old_repository[&quot;installationPath&quot;] = _REDISCOVERY_TOKEN
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>    return old_repository
</code></pre></div></p>
<p>Now, wherever the plugin needs to use this path, we'll need to check for this sentinel value, and error out if we find it.  For example, we might need a valid path during the <code>configure</code> operation:
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>@plugin.virtual.configure()
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>def configure(virtual_source, snapshot, repository):
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>    if repository.installation_path == _REDISCOVERY_TOKEN:
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>        # We cannot use this repository as/is -- it must be rediscovered.
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>        msg = &#39;Unable to use repository &quot;{}&quot; because it has not been updated &#39; \
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>        &#39;since upgrade. Please re-run discovery and try again&#39;
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>        raise UserError(msg.format(repository.name))
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>    # ... actual configure code goes here
</code></pre></div></p>
<h4 id="manual-entry">Manual Entry<a class="headerlink" href="#manual-entry" title="Permanent link">&para;</a></h4>
<p>Above, we looked at an example where the plugin could handle filling in new values for a new field at discovery time, so the user was simply asked to rediscover.</p>
<p>Sometimes, though, users themselves will have to be the ones to supply new values.</p>
<p>Suppose that a new plugin version wants to add a required field to the <code>virtualSource</code> object. This new property will tell which port the database should be accessible on. Ideally, we might want our new field to look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>&quot;port&quot;: {&quot;type&quot;: &quot;integer&quot;, &quot;minimum&quot;: 1024, &quot;maximum&quot;: 65535}
</code></pre></div>
<p>Again, however, the data migration will not know which value is correct here. This is something the user must decide. Still, the data migration must provide <em>some</em> value. As before, we'll change the schema a bit from what would be ideal:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>&quot;port&quot;: {&quot;type&quot;: &quot;integer&quot;, &quot;minimum&quot;: 0, &quot;maximum&quot;: 65535}
</code></pre></div>
<p>Now, our data migration can use the value <code>0</code> as code for "this VDB needs user intervention".</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>@plugin.upgrade.virtual_source(&quot;2020.02.04.02&quot;)
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>def add_dummy_port(old_virtual_source):
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>    # Set the &quot;port&quot; property to 0 to act as a placeholder.
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>    old_virtual_source[&quot;port&quot;] = 0
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>    return old_virtual_source
</code></pre></div>
<p>As with the previous example, our plugin code will need to look for this special value, and raise an error so that the user knows what to do. This example shows the <a href="../../References/Plugin_Operations/#virtual-source-reconfigure">Virtual Source Reconfigure</a> operation, but of course, similar code will be needed anywhere else that the new <code>port</code> property is required.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>@plugin.virtual.reconfigure()
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>def virtual_reconfigure(virtual_source, repository, source_config, snapshot):
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    if virtual_source.parameters.port == 0:
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>        raise UserError(&#39;VDB &quot;{}&quot; cannot function properly. Please choose a &#39; \
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>        &#39;port number for this VDB to use.&#39;.format(virtual_source.parameters.name))
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>    # ... actual reconfigure code goes here
</code></pre></div>


  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../Versioning/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Versioning" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Versioning
              </div>
            </div>
          </a>
        
        
          
          <a href="../Compatibility/" class="md-footer__link md-footer__link--next" aria-label="Next: Compatibility" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Compatibility
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Delphix Corp.
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.delphix.com/" target="_blank" rel="noopener" title="www.delphix.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M208 80c0-26.5 21.5-48 48-48h64c26.5 0 48 21.5 48 48v64c0 26.5-21.5 48-48 48h-8v40h152c30.9 0 56 25.1 56 56v32h8c26.5 0 48 21.5 48 48v64c0 26.5-21.5 48-48 48h-64c-26.5 0-48-21.5-48-48v-64c0-26.5 21.5-48 48-48h8v-32c0-4.4-3.6-8-8-8H312v40h8c26.5 0 48 21.5 48 48v64c0 26.5-21.5 48-48 48h-64c-26.5 0-48-21.5-48-48v-64c0-26.5 21.5-48 48-48h8v-40H112c-4.4 0-8 3.6-8 8v32h8c26.5 0 48 21.5 48 48v64c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48v-64c0-26.5 21.5-48 48-48h8v-32c0-30.9 25.1-56 56-56h152v-40h-8c-26.5 0-48-21.5-48-48V80z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/DelphixCorp/" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="m279.14 288 14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/delphix" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/delphix" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/delphix" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer", "navigation.tabs", "navigation.tabs.sticky", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.51198bba.min.js"></script>
      
    
  </body>
</html>