



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/logo.png">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.2">
    
    
      
        <title>Discovery - Delphix Virtualization SDK 2.0.0</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.fbb7f3af.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Helvetica+Neue:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Helvetica Neue","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#discovery" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Delphix Virtualization SDK 2.0.0" class="md-header-nav__button md-logo">
          
            <img src="../../images/delphix-logo-white.png" width="153" height="15">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Delphix Virtualization SDK 2.0.0
              </span>
              <span class="md-header-nav__topic">
                Discovery
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/delphix-logo-white.png" width="48" height="48">
      
    </span>
    Delphix Virtualization SDK 2.0.0
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Welcome!" class="md-nav__link">
      Welcome!
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Getting_Started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Building Your First Plugin
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Building Your First Plugin
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Initial_Setup/" title="Initial Setup" class="md-nav__link">
      Initial Setup
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Discovery
      </label>
    
    <a href="./" title="Discovery" class="md-nav__link md-nav__link--active">
      Discovery
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-discovery" title="What is Discovery?" class="md-nav__link">
    What is Discovery?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source-configs-and-repositories" title="Source Configs and Repositories" class="md-nav__link">
    Source Configs and Repositories
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-are-source-configs-and-repositories" title="What are Source Configs and Repositories?" class="md-nav__link">
    What are Source Configs and Repositories?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-your-data-formats" title="Defining Your Data Formats" class="md-nav__link">
    Defining Your Data Formats
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#repository-schema" title="Repository Schema" class="md-nav__link">
    Repository Schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#source-config-schema" title="Source Config Schema" class="md-nav__link">
    Source Config Schema
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-discovery-in-your-plugin" title="Implementing Discovery in Your Plugin" class="md-nav__link">
    Implementing Discovery in Your Plugin
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#about-python-code" title="About Python Code" class="md-nav__link">
    About Python Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-look-at-the-generated-code" title="A Look at the Generated Code" class="md-nav__link">
    A Look at the Generated Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repository-discovery" title="Repository Discovery" class="md-nav__link">
    Repository Discovery
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#source-config-discovery" title="Source Config Discovery" class="md-nav__link">
    Source Config Discovery
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-run-discovery-in-the-delphix-engine" title="How to Run Discovery in the Delphix Engine" class="md-nav__link">
    How to Run Discovery in the Delphix Engine
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Data_Ingestion/" title="Data Ingestion" class="md-nav__link">
      Data Ingestion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Provisioning/" title="Provisioning" class="md-nav__link">
      Provisioning
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Versioning And Upgrade
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Versioning And Upgrade
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Versioning_And_Upgrade/Overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Versioning_And_Upgrade/Versioning/" title="Versioning" class="md-nav__link">
      Versioning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Versioning_And_Upgrade/Upgrade/" title="Upgrade" class="md-nav__link">
      Upgrade
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Versioning_And_Upgrade/Compatibility/" title="Compatibility" class="md-nav__link">
      Compatibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Versioning_And_Upgrade/Backports_And_Hotfixes/" title="Backports and Hotfixes" class="md-nav__link">
      Backports and Hotfixes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Versioning_And_Upgrade/Replication/" title="Replication" class="md-nav__link">
      Replication
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      References
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        References
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/CLI/" title="CLI" class="md-nav__link">
      CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Plugin_Config/" title="Plugin Config" class="md-nav__link">
      Plugin Config
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Decorators/" title="Decorators" class="md-nav__link">
      Decorators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Plugin_Operations/" title="Plugin Operations" class="md-nav__link">
      Plugin Operations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Schemas/" title="Schemas" class="md-nav__link">
      Schemas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Schemas_and_Autogenerated_Classes/" title="Schemas and Autogenerated Classes" class="md-nav__link">
      Schemas and Autogenerated Classes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Platform_Libraries/" title="Platform Libraries" class="md-nav__link">
      Platform Libraries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Logging/" title="Logging" class="md-nav__link">
      Logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Workflows/" title="Workflows" class="md-nav__link">
      Workflows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Classes/" title="Classes" class="md-nav__link">
      Classes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Best Practices
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Best Practices
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Best_Practices/CLI_Configuration_File/" title="CLI Configuration File" class="md-nav__link">
      CLI Configuration File
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Best_Practices/Code_Sharing/" title="Code Sharing" class="md-nav__link">
      Code Sharing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Best_Practices/Managing_Scripts_For_Remote_Execution/" title="Managing Scripts for Remote Execution" class="md-nav__link">
      Managing Scripts for Remote Execution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Best_Practices/User_Visible_Errors/" title="User Visible Errors" class="md-nav__link">
      User Visible Errors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Best_Practices/Sensitive_Data/" title="Dealing With Sensitive Data" class="md-nav__link">
      Dealing With Sensitive Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Best_Practices/Unicode_Data/" title="Working with Unicode Data" class="md-nav__link">
      Working with Unicode Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Best_Practices/Working_with_Powershell/" title="Working with Powershell" class="md-nav__link">
      Working with Powershell
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Release Notes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Release Notes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1" type="checkbox" id="nav-7-1">
    
    <label class="md-nav__link" for="nav-7-1">
      2.0.0
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-1">
        2.0.0
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Release_Notes/2.0.0/2.0.0/" title="Release - GA (v2.0.0)" class="md-nav__link">
      Release - GA (v2.0.0)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Release_Notes/2.0.0/2.0.0_Breaking_Changes/" title="Breaking Changes - GA (v.2.0.0)" class="md-nav__link">
      Breaking Changes - GA (v.2.0.0)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">
    
    <label class="md-nav__link" for="nav-7-2">
      1.0.0
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-2">
        1.0.0
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Release_Notes/1.0.0/1.0.0/" title="Release - GA (v1.0.0)" class="md-nav__link">
      Release - GA (v1.0.0)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Release_Notes/1.0.0/1.0.0_Breaking_Changes/" title="Breaking Changes - GA (v.1.0.0)" class="md-nav__link">
      Breaking Changes - GA (v.1.0.0)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">
    
    <label class="md-nav__link" for="nav-7-3">
      0.4.0
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-3">
        0.4.0
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Release_Notes/0.4.0/0.4.0/" title="Release - Early Preview 2 (v0.4.0)" class="md-nav__link">
      Release - Early Preview 2 (v0.4.0)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Release_Notes/0.4.0/0.4.0_Breaking_Changes/" title="Breaking Changes - Early Preview 2 (v.0.4.0)" class="md-nav__link">
      Breaking Changes - Early Preview 2 (v.0.4.0)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-discovery" title="What is Discovery?" class="md-nav__link">
    What is Discovery?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source-configs-and-repositories" title="Source Configs and Repositories" class="md-nav__link">
    Source Configs and Repositories
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-are-source-configs-and-repositories" title="What are Source Configs and Repositories?" class="md-nav__link">
    What are Source Configs and Repositories?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-your-data-formats" title="Defining Your Data Formats" class="md-nav__link">
    Defining Your Data Formats
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#repository-schema" title="Repository Schema" class="md-nav__link">
    Repository Schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#source-config-schema" title="Source Config Schema" class="md-nav__link">
    Source Config Schema
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-discovery-in-your-plugin" title="Implementing Discovery in Your Plugin" class="md-nav__link">
    Implementing Discovery in Your Plugin
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#about-python-code" title="About Python Code" class="md-nav__link">
    About Python Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-look-at-the-generated-code" title="A Look at the Generated Code" class="md-nav__link">
    A Look at the Generated Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repository-discovery" title="Repository Discovery" class="md-nav__link">
    Repository Discovery
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#source-config-discovery" title="Source Config Discovery" class="md-nav__link">
    Source Config Discovery
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-run-discovery-in-the-delphix-engine" title="How to Run Discovery in the Delphix Engine" class="md-nav__link">
    How to Run Discovery in the Delphix Engine
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="discovery">Discovery<a class="headerlink" href="#discovery" title="Permanent link">&para;</a></h1>
<h2 id="what-is-discovery">What is Discovery?<a class="headerlink" href="#what-is-discovery" title="Permanent link">&para;</a></h2>
<p>In order to ingest data from a source environment, the Delphix Engine first needs to learn information about the data: Where does it live? How can it be accessed? What is it called?</p>
<p><a href="../../References/Glossary/#discovery">Discovery</a> is the process by which the Delphix Engine learns about remote data. Discovery can be either:</p>
<ul>
<li><a href="../../References/Glossary/#automatic-discovery">automatic</a> — where the plugin finds the remote data on its own</li>
<li><a href="../../References/Glossary/#manual-discovery">manual</a> — where the user tells us about the remote data</li>
</ul>
<p>For our first plugin, we will be using a mix of these two techniques.</p>
<h2 id="source-configs-and-repositories">Source Configs and Repositories<a class="headerlink" href="#source-configs-and-repositories" title="Permanent link">&para;</a></h2>
<h3 id="what-are-source-configs-and-repositories">What are Source Configs and Repositories?<a class="headerlink" href="#what-are-source-configs-and-repositories" title="Permanent link">&para;</a></h3>
<p>A <a href="../../References/Glossary/#source-config">source config</a> is a collection of information that Delphix uses to represent a dataset. Different plugins will have different ideas about what a "dataset" is (an entire database? a set of config files? an application?). For our first plugin, it is simply a directory tree on the filesystem of the remote environment.</p>
<p>A <a href="../../References/Glossary/#repository">repository</a> represents what you might call "data dependencies" -- anything installed on the remote host that the dataset depends on. For example, if you are working with a Postgres database, then your repository will represent an installation of a particular version of the Postgres DBMS. In this plugin, we do not have any special dependencies, except for the simple existence of the unix system on which the directory lives.</p>
<p>We will be using automatic discovery for our repositories, and manual discovery for our source configs. This is the default configuration that is created by <code>dvp init</code>, so there is nothing further we need to do here.</p>
<h3 id="defining-your-data-formats">Defining Your Data Formats<a class="headerlink" href="#defining-your-data-formats" title="Permanent link">&para;</a></h3>
<p>Because each plugin will have different ideas about what a repository or source config represents, different plugins will have different sets of information that they need to collect and store.</p>
<p>Delphix needs to know the format of this information. How many pieces of information are collected? What are they called? Are they strings? Numbers?</p>
<p>For our first plugin, we do not need a lot of information. We use no special information about our repositories (except some way for the user to identify them). For source configs, all we need to know is the path to the directory from which we will be ingesting data.</p>
<p>The plugin needs to describe all of this to the Delphix Engine, and it does so using <a href="../../References/Glossary/#schema">schemas</a>.  Recall that when we ran <code>dvp init</code>, a file full of bare-bones schemas was created. As we build up our first toolkit, we will be augmenting these schemas to serve our needs.</p>
<h4 id="repository-schema">Repository Schema<a class="headerlink" href="#repository-schema" title="Permanent link">&para;</a></h4>
<p>Open up the <code>schema.json</code> file in your editor/IDE and locate <code>repositoryDefinition</code>, it should look like this:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;repositoryDefinition&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
        <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
        <span class="p">},</span>
        <span class="nt">&quot;nameField&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
        <span class="nt">&quot;identityFields&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Since we do not have any special dependencies, we can just leave it as-is.</p>
<p>For detailed information about exactly how repository schemas work, see <a href="../../References/Schemas/">the reference page</a>.</p>
<p>In brief, what we are doing here is saying that each of our repositories will have a single property called <code>name</code>, which will be used both as a unique identifier and as the user-visible name of the repository.</p>
<h4 id="source-config-schema">Source Config Schema<a class="headerlink" href="#source-config-schema" title="Permanent link">&para;</a></h4>
<p>For source configs, the bare-bones schema is not going to be good enough. Recall that for us, a source config represents a directory tree on a remote environment.</p>
<p>Locate the <code>sourceConfigDefinition</code> inside the <code>schema.json</code> file and modify the definition so it looks like this:</p>
<div class="codehilite"><pre><span></span><span class="s2">&quot;sourceConfigDefinition&quot;</span><span class="err">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
    <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">],</span>
    <span class="nt">&quot;additionalProperties&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
          <span class="nt">&quot;prettyName&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataset Name&quot;</span><span class="p">,</span>
          <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;User-visible name for this dataset&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
          <span class="nt">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;unixpath&quot;</span><span class="p">,</span>
          <span class="nt">&quot;prettyName&quot;</span><span class="p">:</span> <span class="s2">&quot;Path&quot;</span><span class="p">,</span>
          <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Full path to data location on the remote environment&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;nameField&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
    <span class="nt">&quot;identityFields&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span>
<span class="p">}</span><span class="err">,</span>
</pre></div>


<p>Now, we have two properties, a property <code>name</code> serving as the user-visible name of the source config and <code>path</code> which tells us where the data lives on the remote host. Note  we are using <code>path</code> as the unique identifier.</p>
<p>Because we are using manual discovery, the end user is going to be responsible for filling in values for <code>name</code> and <code>path</code>. So, we have added some things to our schema that we did not need for repositories.</p>
<p>The <code>prettyName</code> and <code>description</code> entries will be used by the UI to tell the user what these fields mean.</p>
<p>Because we set <code>additionalProperties</code> to <code>false</code>, this will prevent users from supplying properties other than <code>name</code> and <code>path</code>.</p>
<p>Finally, we have specified that the <code>path</code> property must be a well-formatted Unix path. This allows the UI to enforce that the format is correct before the user is allowed to proceed. (Note this only enforces the format, and does not actually check to see if the path really exists on some remote environment!)</p>
<p>Refer to the reference page for <a href="../../References/Schemas/">Schemas</a> for more details about these entries, and for other things that you can do in these schemas.</p>
<h2 id="implementing-discovery-in-your-plugin">Implementing Discovery in Your Plugin<a class="headerlink" href="#implementing-discovery-in-your-plugin" title="Permanent link">&para;</a></h2>
<h3 id="about-python-code">About Python Code<a class="headerlink" href="#about-python-code" title="Permanent link">&para;</a></h3>
<p>As described in the overview section, plugins customize the behavior of the Delphix Engine by providing Python code. Each customizable piece of behavior is called a "plugin operation". The plugin provides separate Python functions for each of the operations that it wants to customize.</p>
<p>Right now, we are concerned with discovery. There are two customizable operations related to automatic discovery, one for repositories and one for source configs. In both cases, the job of the Python method is to automatically collect whatever information the schemas (see above) require, and to return that information to the Delphix Engine. The Delphix Engine will run these customized operations whenever a new environment is added, or when an existing environment is rediscovered.</p>
<h3 id="a-look-at-the-generated-code">A Look at the Generated Code<a class="headerlink" href="#a-look-at-the-generated-code" title="Permanent link">&para;</a></h3>
<p>Recall that the <code>dvp init</code> command we ran created a file called <code>src/plugin_runner.py</code>. Open this file in your editor/IDE. You will see that this file already contains a bunch of Python code. Let's take a look at the first three blocks of code in this file.</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">dlpx.virtualization.platform</span> <span class="kn">import</span> <span class="n">Mount</span><span class="p">,</span> <span class="n">MountSpecification</span><span class="p">,</span> <span class="n">Plugin</span>

<span class="kn">from</span> <span class="nn">generated.definitions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">RepositoryDefinition</span><span class="p">,</span>
    <span class="n">SourceConfigDefinition</span><span class="p">,</span>
    <span class="n">SnapshotDefinition</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>


<p>These <code>import</code> lines make certain functionality available to our Python code. Some of this functionality will
be used just below, as we implement discovery. Others will be used later on, as we implement
ingestion and provisioning. Later, you'll add more <code>import</code>s to unlock more functionality.</p>
<div class="codehilite"><pre><span></span><span class="n">plugin</span> <span class="o">=</span> <span class="n">Plugin</span><span class="p">()</span>
</pre></div>


<p>This line creates a Python object which allows us to define our plugin types. We have the ability to do this because of the <code>import Plugin</code> statement above.</p>
<p>This object is stored in a variable we have elected to call <code>plugin</code>. We are free to call this variable anything we want, so long as we also change the <code>entryPoint</code> line in the <code>plugin_config.yml</code> file. For this example, we will just leave it as <code>plugin</code>.</p>
<div class="codehilite"><pre><span></span><span class="c1">#</span>
<span class="c1"># Below is an example of the repository discovery operation.</span>
<span class="c1">#</span>
<span class="c1"># NOTE: The decorators are defined on the &#39;plugin&#39; object created above.</span>
<span class="c1">#</span>
<span class="c1"># Mark the function below as the operation that does repository discovery.</span>
<span class="nd">@plugin.discovery.repository</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">repository_discovery</span><span class="p">(</span><span class="n">source_connection</span><span class="p">):</span>
    <span class="c1">#</span>
    <span class="c1"># This is an object generated from the repositoryDefinition schema.</span>
    <span class="c1"># In order to use it locally you must run the &#39;build -g&#39; command provided</span>
    <span class="c1"># by the SDK tools from the plugin&#39;s root directory.</span>
    <span class="c1">#</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">RepositoryDefinition</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;1e87dc30-3cdb-4f0a-9634-07ce017d20d1&#39;</span><span class="p">)]</span>
</pre></div>


<p>This is our first <a href="../../References/Plugin_Operations/">plugin operation</a>. In this case, it's defining what will happen when the Delphix Engine wants to discover repositories on an environment.  Let's take a look at this code line-by-line</p>
<div class="codehilite"><pre><span></span><span class="nd">@plugin.discovery.repository</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">repository_discovery</span><span class="p">(</span><span class="n">source_connection</span><span class="p">):</span>
</pre></div>


<p>This begins the definition of a function called <code>repository_discovery</code>.</p>
<p>We are using a Python <a href="../../References/Glossary/#decorator">decorator</a> which signals to the Delphix Engine that this is the function which should be called when it is time to do repository discovery. The actual name of the function doesn't matter here. Note that we are using our <code>plugin</code> variable here as part of the decorator.</p>
<p>The Delphix Engine will pass us information about the source environment in an argument called <code>source_connection</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The name of this input argument matters. That is, you'll always need to have an argument called
<code>source_connection</code> here. Each plugin operation has its own set of required argument names. For
details on which arguments apply to which operations, see the <a href="../../References/Plugin_Operations/">reference section</a>.</p>
</div>
<div class="codehilite"><pre><span></span>    <span class="k">return</span> <span class="p">[</span><span class="n">RepositoryDefinition</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;1e87dc30-3cdb-4f0a-9634-07ce017d20d1&#39;</span><span class="p">)]</span>
</pre></div>


<p>This creates and returns a Python object that corresponds to the format defined by our repository schema. Because out repository has exactly one string property called <code>name</code>, therefore this Python object has one property called <code>name</code>.</p>
<p>Notice that the code generator has filled in the value of <code>name</code> with a random string. This results in a plugin operation that works, but which will not be very helpful for the user. We'll change this later.</p>
<p>The rest of the file contains more plugin operations, and we'll be modifying them later.</p>
<h3 id="repository-discovery">Repository Discovery<a class="headerlink" href="#repository-discovery" title="Permanent link">&para;</a></h3>
<p>Now, we need to modify the provided <a href="../../References/Plugin_Operations/#repository-discovery">repository discovery</a> operation. This operation will examine a remote environment, find any repositories, and return information about them to the Delphix Engine.</p>
<p>As a reminder, our only external dependency on the remote environment is simply the existence of a filesystem. Since every Unix host has a filesystem, that means we will have exactly one repository per remote environment. Therefore, our repository discovery operation can be very simple.</p>
<p>In fact, as we saw above, the default-generated <code>repository_discovery</code> function does almost exactly what we want -- it returns one single repository for any Unix host that it is asked to work with. The only problem with it is that it uses
unhelpful name.  That's really easy to change!</p>
<p>Replace or modify <code>repository_discovery</code> so it looks like this:</p>
<div class="codehilite"><pre><span></span><span class="nd">@plugin.discovery.repository</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">repository_discovery</span><span class="p">(</span><span class="n">source_connection</span><span class="p">):</span>
    <span class="n">repository</span> <span class="o">=</span> <span class="n">RepositoryDefinition</span><span class="p">(</span><span class="s1">&#39;Repository for our First Plugin&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">repository</span><span class="p">]</span>
</pre></div>


<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Be careful to always use consistent indentation in Python code!</p>
</div>
<h3 id="source-config-discovery">Source Config Discovery<a class="headerlink" href="#source-config-discovery" title="Permanent link">&para;</a></h3>
<p>For source configs, we will rely solely on manual discovery. Therefore, the user will tell us which directories they want to ingest from. We still have to define a source config discovery operation -- it just won't need to do much.</p>
<p>The job of this operation is to return only source configs associated with the given <code>repository</code>. This function will be called once per repository. In our case, that means it will only be called once.</p>
<p>Because we want to supply <strong>no</strong> automatically-discovered source configs, this function should simply returns an empty list.</p>
<p>In fact, <code>dvp init</code> has already generated a function for us that does exactly this.</p>
<div class="codehilite"><pre><span></span><span class="nd">@plugin.discovery.source_config</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">source_config_discovery</span><span class="p">(</span><span class="n">source_connection</span><span class="p">,</span> <span class="n">repository</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>


<p>If we wanted to do automatic discovery of source configs, we'd modify this function. But, for our purposes now, the existing code is fine and we don't need to change anything.</p>
<h2 id="how-to-run-discovery-in-the-delphix-engine">How to Run Discovery in the Delphix Engine<a class="headerlink" href="#how-to-run-discovery-in-the-delphix-engine" title="Permanent link">&para;</a></h2>
<p>Let us make sure discovery works!</p>
<ol>
<li>
<p>Run the <code>dvp build</code> commands, as before. This will build the plugin, with all of the new changes, and create an artifact.</p>
</li>
<li>
<p>Run <code>dvp upload -e &lt;engine&gt; -u &lt;user&gt;</code>, as before. This will get all the new changes onto the Delphix Engine.</p>
</li>
<li>
<p>Once the new plugin is uploaded, add a remote unix environment to your engine. To do this, go to <strong>Manage &gt; Environments</strong>, chose <strong>Add Environment</strong> from the menu, answer the questions, and <strong>Submit</strong>. (If you already have an environment set up, you can just refresh it instead).</p>
</li>
</ol>
<p>To keep an eye on this discovery process, you may need to open the <strong>Actions</strong> tab on the UI. If any errors happen, they will be reported here.</p>
<ol>
<li>After the automatic discovery process completes, go to the <strong>Databases</strong> tab. You will see an entry for <strong>Repository For Our First Plugin</strong>. This is the repository you created in your Python code.</li>
</ol>
<p><img alt="Screenshot" src="../images/PostDiscovery.png" /></p>
<p>Notice that it says <em>No databases found on installation</em>. This is because we chose not to do automatic source config discovery.</p>
<p>However, because we have allowed manual source config discovery, you can add your own entries by clicking the plus sign (<strong>Add Database</strong>). Complete the information in the Add Database dialog and click Add.</p>
<p><img alt="Screenshot" src="../images/AddDatabase.png" /></p>
<p>This should all look familiar. It is precisely what we defined in our source config schema. As expected, there are two entries, one for our <code>name</code> property, and one for <code>path</code>.</p>
<p>For example, in the above screenshot, we are specifying that we want to sync the <code>/bin</code> directory
from the remote host, and we want to call it <code>Binaries</code>. You can pick any directory and name that
you want.</p>
<p>Once you have added one or more source configs, you will be able to sync. This is covered on the next page.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Once you have automatically or manually created source configs, you will not be allowed to modify your plugin's source config schema. We will cover how to deal with this later in the <a href="../../Versioning_And_Upgrade/Upgrade/">upgrade section</a>. For now, if you need to change your plugin's source config schema:</p>
<ul>
<li>You will have to delete any source configs you have manually added.</li>
<li>Delete the plugin and its corresponding objects (dSources, Virtual Sources, etc) if the source configs were manually discovered.</li>
</ul>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Initial_Setup/" title="Initial Setup" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Initial Setup
              </span>
            </div>
          </a>
        
        
          <a href="../Data_Ingestion/" title="Data Ingestion" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Data Ingestion
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 Delphix Corp.
          </div>
        
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://www.delphix.com/" class="md-footer-social__link fa fa-sitemap"></a>
    
      <a href="https://www.facebook.com/DelphixCorp/" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://twitter.com/delphix" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://www.linkedin.com/company/delphix" class="md-footer-social__link fa fa-linkedin"></a>
    
      <a href="https://github.com/delphix" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.878fdd8d.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-35429885-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>